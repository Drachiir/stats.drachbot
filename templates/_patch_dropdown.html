<button class="btn btn-dark btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown"
        aria-expanded="false">
    {{ patch_display }}
</button>
<ul class="dropdown-menu bg-black" style="max-height: 400px; overflow-y: scroll" id="patchDropdown">
    <form id="patchForm">
        {% for p in patch_list %}
            <li class="dropdown-item" id="patch-checkbox">
                <input type="checkbox" class="patch-checkbox" value="{{ p }}">
                <label>v{{ p }}</label>
            </li>
        {% endfor %}
    </form>
    {% if user %}
    <li class="dropdown-item">
        <form onsubmit="redirectToCustomPatch(event)" class="d-flex align-items-center" style="padding-left: 5px">
            <input type="text" id="customPatch" class="form-control form-control-sm me-2" placeholder="26.1a or 12.01.1" style="width: 120px;">
            <button type="submit" class="btn btn-dark btn-outline-light btn-sm">Go</button>
        </form>
    </li>
    {% endif %}
    <li class="dropdown-item text-center" style="position: sticky; bottom: 0; background-color: #000000">
        <button class="btn btn-primary w-100" id="redirectButton">Go</button>
    </li>
</ul>
<script>
    function redirectToCustomPatch(event) {
        event.preventDefault();
        let customPatch = document.getElementById("customPatch").value;
        if (customPatch) {
            // Remove 'v' prefix if user included it
            customPatch = customPatch.replace(/^v/, '');
            window.location.href = "{{ playerurl }}/{{ stats }}/v" + encodeURIComponent(customPatch) + "/{{ elo }}" + 
                {% if specific_key and specific_key != "All" %}
                    "/{{ specific_key }}"
                {% else %}
                    ""
                {% endif %};
        }
    }
</script>