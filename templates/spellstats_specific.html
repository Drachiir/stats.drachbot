{% extends 'base.html' %}

{% block content %}
<div style="padding-top: 15px;">
    <img style="float:left; padding-right: 20px;" src="https://cdn.legiontd2.com/icons/{{get_unit_name(specific_spell)}}.png">
    <r style="font-size: 1.5rem;" class="navbar-brand" href="#">{{get_unit_name(specific_spell)}} Spell Stats</r>
    <div style="float:right;">
        <button class="btn btn-dark btn-text-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        Elo
        </button>
        <ul class="dropdown-menu">
            {% for i in elo_brackets %}
            <li><a class="dropdown-item" href="/spellstats/{{patch}}/{{i}}/{{specific_spell}}">{{i}}+</a></li>
            {% endfor %}
        </ul>
        <button class="btn btn-dark btn-text-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        Patch
        </button>
        <ul class="dropdown-menu">
            {% for p in patch_list %}
            <li><a class="dropdown-item" href="/spellstats/{{p}}/{{elo}}/{{specific_spell}}">v{{p}}</a></li>
            {% endfor %}
        </ul>
    </div>
    <br>
    <r style="font-size: 1rem;" > <b>{{human_format(data[specific_spell]['Count'])}}</b> Games | Winrate: <b>{{custom_winrate([data[specific_spell]['Wins'], data[specific_spell]['Count']])}}%</b> | <b>v{{patch}}</b></r>
<table style= "margin-top:  20px; display: inline-block; overflow: auto;" class="table table-striped-columns">
    {% if specific_spell in buff_spells%}
        {% set add_dict = sort_dict(data[specific_spell]['Targets'], 'Count') %}
        <thead>
        <tr>
            <th><r>Targets:</r></th>
            {% for add in add_dict %}
                <th><a href="/unitstats/{{patch}}/{{elo}}/{{add}}"><img style="border: 1px solid #999;" src="https://cdn.legiontd2.com/icons/{{get_unit_name(add)}}.png"></a></th>
            {% endfor %}
        </tr>
        </thead>
        <tr>
            <td><r>Games:</r></td>
        {% for add in add_dict %}
            <td><r>{{add_dict[add]['Count']}}</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Winrate:</r></td>
        {% for add in add_dict %}
            {% set count = add_dict[add]['Count'] %}
            {% set wins = add_dict[add]['Wins'] %}
            <td><r>{{custom_winrate([wins, count])}}%</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Playrate:</r></td>
        {% for add in add_dict %}
            {% set count = add_dict[add]['Count'] %}
            <td><r>{{custom_winrate([count, data[specific_spell]['Count']])}}%</r></td>
        {% endfor %}
        </tr>
        {% set open_dict = sort_dict(data[specific_spell]['Opener'], 'Count') %}
        <tr>
            <td><r>Openers:</r></td>
        {% for mm in open_dict %}
            <td><a href="/openstats/{{patch}}/{{elo}}/{{mm|lower}}"><img style="border: 1px solid #999;" src="https://cdn.legiontd2.com/icons/{{get_unit_name(mm)}}.png"></a></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Games:</r></td>
        {% for mm in open_dict %}
            <td><r>{{open_dict[mm]['Count']}}</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Winrate:</r></td>
        {% for mm in open_dict %}
            {% set count = open_dict[mm]['Count'] %}
            {% set wins = open_dict[mm]['Wins'] %}
            <td><r>{{custom_winrate([wins, count])}}%</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Playrate:</r></td>
        {% for mm in open_dict %}
            {% set count = open_dict[mm]['Count'] %}
            <td><r>{{custom_winrate([count, data[specific_spell]['Count']])}}%</r></td>
        {% endfor %}
        </tr>
            {% set mm_dict = sort_dict(data[specific_spell]['MMs'], 'Count') %}
        <tr>
            <td><r>MMs:</r></td>
        {% for mm in mm_dict %}
            <td><a href="/mmstats/{{patch}}/{{elo}}/{{mm}}"><img style="border: 1px solid #999;" src="https://cdn.legiontd2.com/icons/Items/{{mm}}.png"></a></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Games:</r></td>
        {% for mm in mm_dict %}
            <td><r>{{mm_dict[mm]['Count']}}</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Winrate:</r></td>
        {% for mm in mm_dict %}
            {% set count = mm_dict[mm]['Count'] %}
            {% set wins = mm_dict[mm]['Wins'] %}
            <td><r>{{custom_winrate([wins, count])}}%</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Playrate:</r></td>
        {% for mm in mm_dict %}
            {% set count = mm_dict[mm]['Count'] %}
            <td><r>{{custom_winrate([count, data[specific_spell]['Count']])}}%</r></td>
        {% endfor %}
        </tr>
    {% else %}
        {% set open_dict = sort_dict(data[specific_spell]['Opener'], 'Count') %}
        <thead>
        <tr>
            <th><r>Openers:</r></th>
        {% for mm in open_dict %}
            <th><a href="/openstats/{{patch}}/{{elo}}/{{mm|lower}}"><img style="border: 1px solid #999;" src="https://cdn.legiontd2.com/icons/{{get_unit_name(mm)}}.png"></a></th>
        {% endfor %}
        </tr>
        </thead>
        <tr>
            <td><r>Games:</r></td>
        {% for mm in open_dict %}
            <td><r>{{open_dict[mm]['Count']}}</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Winrate:</r></td>
        {% for mm in open_dict %}
            {% set count = open_dict[mm]['Count'] %}
            {% set wins = open_dict[mm]['Wins'] %}
            <td><r>{{custom_winrate([wins, count])}}%</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Playrate:</r></td>
        {% for mm in open_dict %}
            {% set count = open_dict[mm]['Count'] %}
            <td><r>{{custom_winrate([count, data[specific_spell]['Count']])}}%</r></td>
        {% endfor %}
        </tr>
            {% set mm_dict = sort_dict(data[specific_spell]['MMs'], 'Count') %}
        <tr>
            <td><r>MMs:</r></td>
        {% for mm in mm_dict %}
            <td><a href="/mmstats/{{patch}}/{{elo}}/{{mm}}"><img style="border: 1px solid #999;" src="https://cdn.legiontd2.com/icons/Items/{{mm}}.png"></a></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Games:</r></td>
        {% for mm in mm_dict %}
            <td><r>{{mm_dict[mm]['Count']}}</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Winrate:</r></td>
        {% for mm in mm_dict %}
            {% set count = mm_dict[mm]['Count'] %}
            {% set wins = mm_dict[mm]['Wins'] %}
            <td><r>{{custom_winrate([wins, count])}}%</r></td>
        {% endfor %}
        </tr>
        <tr>
            <td><r>Playrate:</r></td>
        {% for mm in mm_dict %}
            {% set count = mm_dict[mm]['Count'] %}
            <td><r>{{custom_winrate([count, data[specific_spell]['Count']])}}%</r></td>
        {% endfor %}
        </tr>
    {% endif %}
</table>
</div>
{% endblock %}